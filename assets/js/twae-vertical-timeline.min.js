class VerticalTimeline extends elementorModules.frontend.handlers.Base{getDefaultSettings(){return{selectors:{wrapper:".twae-vertical",lineInner:".twae-inner-line",yearContainer:".twae-year-container",animationSelector:".twae-labels",contentanimationSelector:".twae-content",loadMoreButton:".twae-ajax-load-more"}}}getDefaultElements(){const selectors=this.getSettings("selectors");return{$wrapper:this.$element.find(selectors.wrapper),$lineInner:this.$element.find(selectors.lineInner),$yearContainer:this.$element.find(selectors.yearContainer),$animationSelector:this.$element.find(selectors.animationSelector),$contentanimationSelector:this.$element.find(selectors.contentanimationSelector),$loadMoreButton:this.$element.find(selectors.loadMoreButton)}}bindEvents(){const timelineWrapper=this.elements.$wrapper;var animationSelector=this.elements.$animationSelector,contentanimationSelector=this.elements.$contentanimationSelector,loadMoreButton=this.elements.$loadMoreButton,labelAnimation=animationSelector&&animationSelector.data("aos"),contentAnimation=contentanimationSelector&&contentanimationSelector.data("aos");const yearContainer=this.elements.$yearContainer;timelineWrapper.length>0&&(animationSelector.length>0||contentanimationSelector.length>0)&&("none"==labelAnimation&&"none"===contentAnimation||(document.addEventListener("clickedLoadMore",(function(e){AOS.init()}),!0),AOS.init(),setTimeout(()=>{AOS.init()},2e3)));var lineFilling=timelineWrapper.data("line-filling");loadMoreButton.length>0&&this.twaeAjaxLoadMore(loadMoreButton,lineFilling),timelineWrapper.hasClass("twae-vertical-right")&&(timelineWrapper.hasClass("twae-label-content-top")||timelineWrapper.hasClass("twae-label-content-inside"))&&yearContainer.length<=0&&timelineWrapper.addClass("twae-year-empty"),"undefined"!==lineFilling&&"on"==lineFilling&&(this.twaeScrollCallback(),window.addEventListener("scroll",()=>{this.twaeScrollCallback()}),elementorFrontend.hooks.addAction("frontend/twaeWidget/mediaSlideChange",e=>{this.twaeScrollCallback()}))}twaeScrollCallback(){if(this.elements.$wrapper.length<=0)return;const timelineWrapper=this.elements.$wrapper;var lineInner=this.elements.$lineInner,yearContainer=this.elements.$yearContainer,line_outer=timelineWrapper.find(".twae-line");const timelineEntry=timelineWrapper.find(".twae-repeater-item"),oneSidedLayout=timelineWrapper.hasClass("twae-vertical-right")||timelineWrapper.hasClass("twae-vertical-left"),screenSize=window.innerWidth;if(timelineWrapper.length<1)return!1;var rootElement=document.documentElement,halfViewport=jQuery(window).height()/2,lineID=line_outer[0];if(null!=lineID){var rect=lineID.getBoundingClientRect(),timelineTop,lineInnerHeight=(timelineTop=rect.top<0?Math.abs(rect.top):-Math.abs(rect.top))+halfViewport,lineOuterHeight=line_outer.outerHeight(),timelineWrapperPosition,timelineWrapperTop=jQuery(timelineWrapper).offset().top-rootElement.scrollTop,timelineEntryPosition,timelineEntryTop,yearContainerPos,yearContainerTop;timelineWrapper.addClass("twae-start-out-viewport"),lineInnerHeight<=lineOuterHeight?(timelineWrapper.addClass("twae-end-out-viewport"),timelineWrapper.addClass("twae-start-out-viewport"),lineInner.height(lineInnerHeight),timelineWrapperTop<halfViewport&&(timelineWrapper.removeClass("twae-start-out-viewport"),timelineWrapper.addClass("twae-start-fill"))):(timelineWrapper.removeClass("twae-end-out-viewport"),timelineWrapper.addClass("twae-end-fill"),lineInner.height(lineOuterHeight));for(var i=0;i<timelineEntry.length;i++){const icon=jQuery(timelineEntry[i]).find(".twae-icon, .twae-icondot"),iconPosition=icon.length>0?icon[0].offsetTop:0;(timelineEntryTop=(timelineEntryPosition=jQuery(timelineEntry[i]).offset().top+iconPosition)-rootElement.scrollTop)<halfViewport?timelineEntry[i].classList.remove("twae-out-viewport"):timelineEntry[i].classList.add("twae-out-viewport")}for(var i=0;i<yearContainer.length;i++){if(yearContainerTop=(yearContainerPos=jQuery(yearContainer[i]).offset().top)-rootElement.scrollTop,oneSidedLayout||768>screenSize){const yearLabel=jQuery(yearContainer[i]).find(".twae-year-label"),yearBorderSize=parseInt(yearLabel.css("border-width"));let yearHeight;yearContainerTop=yearContainerTop+yearLabel[0].offsetHeight/2-yearBorderSize/2}yearContainerTop<halfViewport?yearContainer[i].classList.remove("twae-out-viewport"):yearContainer[i].classList.add("twae-out-viewport")}}}twaeAjaxLoadMore(loadBtn,lineFilling){loadBtn.on("click",e=>{const timelineWrapper=this.elements.$wrapper;let thisBtn=jQuery(e.currentTarget);thisBtn.find(".lm_default_state").hide(),thisBtn.find(".lm_active_state").show();let widgetId=timelineWrapper.attr("id");widgetId=widgetId.replace("twae-","");const postWindowObject=window["post_timeline_"+widgetId];let allAtts=postWindowObject.attribute;if(!1===timelineWrapper.hasClass("twae-loadMore-complete")){let ajaxUrl=postWindowObject.url,wpNonce=postWindowObject.private_key,pageNo=parseInt(timelineWrapper.attr("data-page-no")),maxPages=parseInt(timelineWrapper.attr("data-total-pages"));const clickedLoadMore=new Event("clickedLoadMore");jQuery.ajax({type:"POST",dataType:"json",url:ajaxUrl,data:{action:"twae_post_load_more",private_key:wpNonce,page_no:pageNo,settings:allAtts},beforeSend:()=>{window["twae_ajax_post_"+widgetId]=!0}}).done(res=>{timelineWrapper.find(".twae-story").last().after(res.html);let thisPage=pageNo+1;timelineWrapper.attr("data-page-no",thisPage),thisBtn.find(".lm_default_state").show(),thisBtn.find(".lm_active_state").hide(),thisPage>=maxPages&&(timelineWrapper.addClass("twae-loadMore-complete"),loadBtn.hide()),document.dispatchEvent(clickedLoadMore),"undefined"!==lineFilling&&"on"==lineFilling&&this.twaeScrollCallback()}).always(res=>{delete window["twae_ajax_post_"+widgetId]})}})}}jQuery(window).on("elementor/frontend/init",()=>{const addHandler=$element=>{elementorFrontend.elementsHandler.addHandler(VerticalTimeline,{$element:$element})};elementorFrontend.hooks.addAction("frontend/element_ready/timeline-widget-addon.default",addHandler),elementorFrontend.hooks.addAction("frontend/element_ready/twae-post-timeline-widget.default",addHandler)});